created virtual environment CPython3.11.5.final.0-64 in 587ms
  creator CPython3Posix(dest=/localscratch/alexort.47560467.0/env, clear=False, no_vcs_ignore=False, global=False)
  seeder FromAppData(download=False, pip=bundle, setuptools=bundle, wheel=bundle, via=copy, app_data_dir=/home/alexort/.local/share/virtualenv)
    added seed packages: pip==23.2.1, setuptools==68.0.0, wheel==0.41.1
  activators BashActivator,CShellActivator,FishActivator,NushellActivator,PowerShellActivator,PythonActivator
Looking in links: /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/einops-0.8.1+computecanada-py3-none-any.whl (from -r requirements.txt (line 1))
Requirement already satisfied: numpy==2.2.2+computecanada in /cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/scipy-stack/2025a/lib/python3.11/site-packages (from -r requirements.txt (line 2)) (2.2.2+computecanada)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3/PyYAML-6.0.2+computecanada-cp311-cp311-linux_x86_64.whl (from -r requirements.txt (line 3))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic/scikit_learn-1.6.1+computecanada-cp311-cp311-linux_x86_64.whl (from -r requirements.txt (line 4))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3/torch-2.7.1+computecanada-cp311-cp311-linux_x86_64.whl (from -r requirements.txt (line 5))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/tqdm-4.67.1+computecanada-py3-none-any.whl (from -r requirements.txt (line 6))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/wandb-0.19.6+computecanada-py3-none-linux_x86_64.whl (from -r requirements.txt (line 7))
Requirement already satisfied: scipy>=1.6.0 in /cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/scipy-stack/2025a/lib/python3.11/site-packages (from scikit_learn==1.6.1+computecanada->-r requirements.txt (line 4)) (1.15.1+computecanada)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/joblib-1.5.1+computecanada-py3-none-any.whl (from scikit_learn==1.6.1+computecanada->-r requirements.txt (line 4))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/threadpoolctl-3.6.0+computecanada-py3-none-any.whl (from scikit_learn==1.6.1+computecanada->-r requirements.txt (line 4))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/filelock-3.18.0+computecanada-py3-none-any.whl (from torch==2.7.1->-r requirements.txt (line 5))
Requirement already satisfied: typing-extensions>=4.10.0 in /cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/ipykernel/2025a/lib/python3.11/site-packages (from torch==2.7.1->-r requirements.txt (line 5)) (4.12.2+computecanada)
Requirement already satisfied: sympy>=1.13.3 in /cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/scipy-stack/2025a/lib/python3.11/site-packages (from torch==2.7.1->-r requirements.txt (line 5)) (1.13.3+computecanada)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/networkx-3.5+computecanada-py3-none-any.whl (from torch==2.7.1->-r requirements.txt (line 5))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/jinja2-3.1.6+computecanada-py3-none-any.whl (from torch==2.7.1->-r requirements.txt (line 5))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/fsspec-2025.7.0+computecanada-py3-none-any.whl (from torch==2.7.1->-r requirements.txt (line 5))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/click-8.2.1+computecanada-py3-none-any.whl (from wandb==0.19.6+computecanada->-r requirements.txt (line 7))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/docker_pycreds-0.4.0+computecanada-py2.py3-none-any.whl (from wandb==0.19.6+computecanada->-r requirements.txt (line 7))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/gitpython-3.1.45+computecanada-py3-none-any.whl (from wandb==0.19.6+computecanada->-r requirements.txt (line 7))
Requirement already satisfied: platformdirs in /cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/ipykernel/2025a/lib/python3.11/site-packages (from wandb==0.19.6+computecanada->-r requirements.txt (line 7)) (3.10.0+computecanada)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3/protobuf-5.29.5+computecanada-cp311-cp311-linux_x86_64.whl (from wandb==0.19.6+computecanada->-r requirements.txt (line 7))
Requirement already satisfied: psutil>=5.0.0 in /cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/ipykernel/2025a/lib/python3.11/site-packages (from wandb==0.19.6+computecanada->-r requirements.txt (line 7)) (6.1.1+computecanada)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/pydantic-2.11.7+computecanada-py3-none-any.whl (from wandb==0.19.6+computecanada->-r requirements.txt (line 7))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/requests-2.32.4+computecanada-py3-none-any.whl (from wandb==0.19.6+computecanada->-r requirements.txt (line 7))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/sentry_sdk-2.33.2+computecanada-py2.py3-none-any.whl (from wandb==0.19.6+computecanada->-r requirements.txt (line 7))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/setproctitle-1.3.4+computecanada-cp311-cp311-linux_x86_64.whl (from wandb==0.19.6+computecanada->-r requirements.txt (line 7))
Requirement already satisfied: setuptools in /localscratch/alexort.47560467.0/env/lib/python3.11/site-packages (from wandb==0.19.6+computecanada->-r requirements.txt (line 7)) (68.0.0)
Requirement already satisfied: six>=1.4.0 in /cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/scipy-stack/2025a/lib/python3.11/site-packages (from docker-pycreds>=0.4.0->wandb==0.19.6+computecanada->-r requirements.txt (line 7)) (1.17.0+computecanada)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/gitdb-4.0.12+computecanada-py3-none-any.whl (from gitpython!=3.1.29,>=1.0.0->wandb==0.19.6+computecanada->-r requirements.txt (line 7))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/annotated_types-0.7.0+computecanada-py3-none-any.whl (from pydantic<3,>=2.6->wandb==0.19.6+computecanada->-r requirements.txt (line 7))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic/pydantic_core-2.33.2+computecanada-cp311-cp311-linux_x86_64.whl (from pydantic<3,>=2.6->wandb==0.19.6+computecanada->-r requirements.txt (line 7))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/typing_inspection-0.4.1+computecanada-py3-none-any.whl (from pydantic<3,>=2.6->wandb==0.19.6+computecanada->-r requirements.txt (line 7))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/charset_normalizer-3.4.2+computecanada-py3-none-any.whl (from requests<3,>=2.0.0->wandb==0.19.6+computecanada->-r requirements.txt (line 7))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/idna-3.10+computecanada-py3-none-any.whl (from requests<3,>=2.0.0->wandb==0.19.6+computecanada->-r requirements.txt (line 7))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/urllib3-2.5.0+computecanada-py3-none-any.whl (from requests<3,>=2.0.0->wandb==0.19.6+computecanada->-r requirements.txt (line 7))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/certifi-2025.7.14+computecanada-py3-none-any.whl (from requests<3,>=2.0.0->wandb==0.19.6+computecanada->-r requirements.txt (line 7))
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/scipy-stack/2025a/lib/python3.11/site-packages (from sympy>=1.13.3->torch==2.7.1->-r requirements.txt (line 5)) (1.3.0+computecanada)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/MarkupSafe-2.1.5+computecanada-cp311-cp311-linux_x86_64.whl (from jinja2->torch==2.7.1->-r requirements.txt (line 5))
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/smmap-5.0.2+computecanada-py3-none-any.whl (from gitdb<5,>=4.0.1->gitpython!=3.1.29,>=1.0.0->wandb==0.19.6+computecanada->-r requirements.txt (line 7))
Installing collected packages: urllib3, typing-inspection, tqdm, threadpoolctl, smmap, setproctitle, PyYAML, pydantic-core, protobuf, networkx, MarkupSafe, joblib, idna, fsspec, filelock, einops, docker-pycreds, click, charset-normalizer, certifi, annotated-types, sentry-sdk, scikit_learn, requests, pydantic, jinja2, gitdb, torch, gitpython, wandb
Successfully installed MarkupSafe-2.1.5+computecanada PyYAML-6.0.2+computecanada annotated-types-0.7.0+computecanada certifi-2025.7.14+computecanada charset-normalizer-3.4.2+computecanada click-8.2.1+computecanada docker-pycreds-0.4.0+computecanada einops-0.8.1+computecanada filelock-3.18.0+computecanada fsspec-2025.7.0+computecanada gitdb-4.0.12+computecanada gitpython-3.1.45+computecanada idna-3.10+computecanada jinja2-3.1.6+computecanada joblib-1.5.1+computecanada networkx-3.5+computecanada protobuf-5.29.5+computecanada pydantic-2.11.7+computecanada pydantic-core-2.33.2+computecanada requests-2.32.4+computecanada scikit_learn-1.6.1+computecanada sentry-sdk-2.33.2+computecanada setproctitle-1.3.4+computecanada smmap-5.0.2+computecanada threadpoolctl-3.6.0+computecanada torch-2.7.1+computecanada tqdm-4.67.1+computecanada typing-inspection-0.4.1+computecanada urllib3-2.5.0+computecanada wandb-0.19.6+computecanada
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Tracking run with wandb version 0.19.6
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Training:   0%|          | 0/7000 [00:00<?, ?epoch/s]Training:   0%|          | 0/7000 [00:00<?, ?epoch/s]
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/alexort/foundational_possum/scripts/run_training.py", line 87, in <module>
    main()
  File "/home/alexort/foundational_possum/scripts/run_training.py", line 73, in main
    train(
  File "/home/alexort/foundational_possum/src/models/training.py", line 39, in train
    for batch_idx, batch_images in enumerate(train_dataloader):
  File "/localscratch/alexort.47560467.0/env/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 733, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/localscratch/alexort.47560467.0/env/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1515, in _next_data
    return self._process_data(data, worker_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/localscratch/alexort.47560467.0/env/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1550, in _process_data
    data.reraise()
  File "/localscratch/alexort.47560467.0/env/lib/python3.11/site-packages/torch/_utils.py", line 750, in reraise
    raise exception
IndexError: Caught IndexError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/localscratch/alexort.47560467.0/env/lib/python3.11/site-packages/torch/utils/data/_utils/worker.py", line 349, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
           ^^^^^^^^^^^^^^^^^^^^
  File "/localscratch/alexort.47560467.0/env/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/localscratch/alexort.47560467.0/env/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/home/alexort/foundational_possum/src/data/data_loader.py", line 32, in __getitem__
    return self._data[sample_id]
           ~~~~~~~~~~^^^^^^^^^^^
IndexError: index 2676 is out of bounds for axis 0 with size 2676

[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /home/alexort/foundational_possum/wandb/offline-run-20250806_160239-cbdrxpiz[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/offline-run-20250806_160239-cbdrxpiz/logs[0m
